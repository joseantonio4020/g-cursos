<div class="estudiante-form-container">
  <div class="card">
    <div class="card-body">
      <h2 class="card-title mb-4">
        <i class="bi" [ngClass]="isEditMode ? 'bi-pencil-square' : 'bi-person-plus'"></i>
        {{ isEditMode ? 'Editar Estudiante' : 'Nuevo Estudiante' }}
      </h2>
      
      <div class="alert alert-success" *ngIf="successMessage">
        <i class="bi bi-check-circle"></i> {{ successMessage }}
      </div>
      
      <div class="alert alert-danger" *ngIf="errorMessage">
        <i class="bi bi-exclamation-triangle"></i> {{ errorMessage }}
      </div>
      
      <form [formGroup]="estudianteForm" (ngSubmit)="onSubmit()">
        <div class="row">
          <div class="col-md-6 mb-3">
            <label for="nombre" class="form-label">Nombre *</label>
            <input 
              type="text" 
              class="form-control" 
              id="nombre"
              formControlName="nombre"
              [class.is-invalid]="nombre?.invalid && nombre?.touched"
              placeholder="Nombre del estudiante">
            
            <div class="invalid-feedback" *ngIf="nombre?.invalid && nombre?.touched">
              <span *ngIf="nombre?.errors?.['required']">El nombre es obligatorio.</span>
              <span *ngIf="nombre?.errors?.['minlength']">Mínimo 2 caracteres.</span>
            </div>
          </div>
          
          <div class="col-md-6 mb-3">
            <label for="apellido" class="form-label">Apellido *</label>
            <input 
              type="text" 
              class="form-control" 
              id="apellido"
              formControlName="apellido"
              [class.is-invalid]="apellido?.invalid && apellido?.touched"
              placeholder="Apellido del estudiante">
            
            <div class="invalid-feedback" *ngIf="apellido?.invalid && apellido?.touched">
              <span *ngIf="apellido?.errors?.['required']">El apellido es obligatorio.</span>
              <span *ngIf="apellido?.errors?.['minlength']">Mínimo 2 caracteres.</span>
            </div>
          </div>
          
          <div class="col-md-6 mb-3">
            <label for="email" class="form-label">Email *</label>
            <input 
              type="email" 
              class="form-control" 
              id="email"
              formControlName="email"
              [class.is-invalid]="email?.invalid && email?.touched"
              placeholder="email@ejemplo.com">
            
            <div class="invalid-feedback" *ngIf="email?.invalid && email?.touched">
              <span *ngIf="email?.errors?.['required']">El email es obligatorio.</span>
              <span *ngIf="email?.errors?.['email']">Ingresa un email válido.</span>
            </div>
          </div>
          
          <div class="col-md-6 mb-3">
            <label for="telefono" class="form-label">Teléfono *</label>
            <input 
              type="text" 
              class="form-control" 
              id="telefono"
              formControlName="telefono"
              [class.is-invalid]="telefono?.invalid && telefono?.touched"
              placeholder="987654321">
            
            <div class="invalid-feedback" *ngIf="telefono?.invalid && telefono?.touched">
              <span *ngIf="telefono?.errors?.['required']">El teléfono es obligatorio.</span>
              <span *ngIf="telefono?.errors?.['pattern']">Ingresa un teléfono válido (9-15 dígitos).</span>
            </div>
          </div>
          
          <div class="col-md-6 mb-3">
            <label for="fechaNacimiento" class="form-label">Fecha de Nacimiento *</label>
            <input 
              type="date" 
              class="form-control" 
              id="fechaNacimiento"
              formControlName="fechaNacimiento"
              [class.is-invalid]="fechaNacimiento?.invalid && fechaNacimiento?.touched">
            
            <div class="invalid-feedback" *ngIf="fechaNacimiento?.invalid && fechaNacimiento?.touched">
              <span *ngIf="fechaNacimiento?.errors?.['required']">La fecha de nacimiento es obligatoria.</span>
            </div>
          </div>
          
          <div class="col-md-6 mb-3">
            <label for="cursoId" class="form-label">Curso *</label>
            <select 
              class="form-select" 
              id="cursoId"
              formControlName="cursoId"
              [class.is-invalid]="cursoId?.invalid && cursoId?.touched">
              <option value="">Seleccionar curso...</option>
              <option *ngFor="let curso of cursos" [value]="curso.id">{{ curso.nombre }}</option>
            </select>
            
            <div class="invalid-feedback" *ngIf="cursoId?.invalid && cursoId?.touched">
              <span *ngIf="cursoId?.errors?.['required']">El curso es obligatorio.</span>
            </div>
          </div>
          
          <div class="col-md-6 mb-3">
            <label for="fechaInscripcion" class="form-label">Fecha de Inscripción *</label>
            <input 
              type="date" 
              class="form-control" 
              id="fechaInscripcion"
              formControlName="fechaInscripcion"
              [class.is-invalid]="fechaInscripcion?.invalid && fechaInscripcion?.touched">
            
            <div class="invalid-feedback" *ngIf="fechaInscripcion?.invalid && fechaInscripcion?.touched">
              <span *ngIf="fechaInscripcion?.errors?.['required']">La fecha de inscripción es obligatoria.</span>
            </div>
          </div>
          
          <div class="col-md-6 mb-3">
            <label for="estado" class="form-label">Estado *</label>
            <select 
              class="form-select" 
              id="estado"
              formControlName="estado"
              [class.is-invalid]="estado?.invalid && estado?.touched">
              <option value="activo">Activo</option>
              <option value="inactivo">Inactivo</option>
              <option value="graduado">Graduado</option>
            </select>
            
            <div class="invalid-feedback" *ngIf="estado?.invalid && estado?.touched">
              <span *ngIf="estado?.errors?.['required']">El estado es obligatorio.</span>
            </div>
          </div>
        </div>
        
        <div class="d-flex justify-content-end gap-2 mt-4">
          <a routerLink="/estudiantes" class="btn btn-secondary">
            <i class="bi bi-x-circle"></i> Cancelar
          </a>
          <button 
            type="submit" 
            class="btn btn-primary"
            [disabled]="loading">
            <span *ngIf="!loading">
              <i class="bi" [ngClass]="isEditMode ? 'bi-check-circle' : 'bi-person-plus'"></i>
              {{ isEditMode ? 'Actualizar' : 'Registrar' }}
            </span>
            <span *ngIf="loading">
              <span class="spinner-border spinner-border-sm me-2"></span>
              Guardando...
            </span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>